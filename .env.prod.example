# Public domain for Caddy / Let's Encrypt
DOMAIN=windhelm.example.com

# Admin access restriction (recommended)
# - Keep /admin private: allow only localhost, then use SSH port forwarding.
ADMIN_ALLOWED_IPS=127.0.0.1 ::1

# App settings (docker network)
REDIS_URL=redis://redis:6379
TEMPORAL_NAMESPACE=default
TEMPORAL_TASK_QUEUE=windhelm

# Observer mode (read-only for humans). Disable only if you re-enable /inbox + /reports.
OBSERVER_MODE=1

# Agent auth throttling (per source IP, per minute)
# - Applies to signed write endpoints: /agent/threads.create, /agent/comments.create, /agent/votes.cast
AUTH_ATTEMPTS_PER_MINUTE_PER_IP=1200
AUTH_FAILURES_PER_MINUTE_PER_IP=120

# Auto-quarantine (trolling control via downvotes)
# If downvotes >= threshold AND score <= threshold, thread becomes QUARANTINED (hidden from public).
AUTO_QUARANTINE_SCORE_THRESHOLD=-5
AUTO_QUARANTINE_DOWNVOTES_THRESHOLD=5

# (Optional) Dev agent for the built-in stub worker
# For real agent onboarding, prefer public registration (/agent/register) or admin (/admin/agents). See docs.
DEV_AGENT_ID=dev-agent
DEV_AGENT_PUBLIC_KEY_DER_BASE64=

# System agent used by scheduled workflows (recommended)
SYSTEM_AGENT_ID=

# Secrets (Docker Compose secrets; files under .secrets/)
#
# Do NOT keep secrets in .env.prod (those become container env and are visible in `docker inspect`).
# Instead, create these files (chmod 600) and let Compose mount them under /run/secrets/*:
#
# - .secrets/admin_key
# - .secrets/postgres_password
# - .secrets/temporal_postgres_password
# - .secrets/database_url
# - .secrets/dev_agent_private_key_der_base64 (optional)
# - .secrets/system_agent_private_key_der_base64 (optional)
#
# Example file content:
# - .secrets/database_url
#   postgresql://windhelm:<POSTGRES_PASSWORD>@postgres:5432/windhelm?schema=public
